@{
    ViewData["Title"] = "Home";
    WeatherData weatherData = ViewBag.WeatherData as WeatherData;
}

<h1>@ViewData["Title"]</h1>

<!-- Notifications -->
<div>
    <h2>Notifications</h2>

    @if (ViewBag.Notifications != null && ((List<DWA_AU24_Lab2_Group_11.Models.Notification>)ViewBag.Notifications).Any())
    {
        <ul>
            @foreach (var notification in (List<DWA_AU24_Lab2_Group_11.Models.Notification>)ViewBag.Notifications)
            {
                <li>
                    <p>@notification.Message</p>
                    <p><strong>Notification Date:</strong> @notification.NotificationDate.ToString("f")</p>

                    <!-- Mark as Read Button -->
                    <form method="post" action="@Url.Action("MarkAsRead", "Home", new { id = notification.Id })">
                        <button type="submit" class="btn btn-info">Mark as Read</button>
                    </form>
                </li>
            }
        </ul>
    }
    else
    {
        <p>No new notifications.</p>
    }
</div>

<!-- Tasks -->
<div>
    <h2>Tasks</h2>

    @if (ViewBag.Tasks != null && ((List<DWA_AU24_Lab2_Group_11.Models.Task>)ViewBag.Tasks).Any())
    {
        <ul>
            @foreach (var task in (List<DWA_AU24_Lab2_Group_11.Models.Task>)ViewBag.Tasks)
            {
                <li>
                    <p><strong>@task.TaskName</strong></p>
                    <p>@task.TaskDescription</p>
                    <p><strong>Due Date:</strong> @task.TaskDate.ToString("f")</p>

                    <!-- Checkbox for marking task as completed -->
                    <form method="post" action="@Url.Action("MarkTaskAsCompleted", "Home", new { id = task.Id })">                        
                        <button type="submit" class="btn btn-success">Mark as Completed</button>
                    </form>
                </li>
            }
        </ul>
    }
    else
    {
        <p>No upcoming tasks.</p>
    }
</div>

<!-- Weather Information -->
<div>
    <h2>Weather Information</h2>
    @if (weatherData != null)
    {
        <div class="card text-center" style="width: 18rem;">
            <img src="@string.Format("https://openweathermap.org/img/wn/{0}@2x.png", weatherData.Icon)" class="card-img-top weather-icon" alt="Weather Icon">
            <div class="card-body">
                <h5 class="card-title">@weatherData.Location</h5>
                <p class="card-text">
                    <strong>Temperature:</strong> @weatherData.Temperature°C<br>
                    <strong>Humidity:</strong> @weatherData.Humidity%
                </p>
            </div>
        </div>
    }
    else
    {
        <p>Unable to fetch weather data at this time.</p>
    }
</div>
